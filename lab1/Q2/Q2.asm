	.ORIG x3000
	LDI R0, INPUT
	LEA R6, TWO
	LDR R6, R6, #0

REVERSE	AND R1, R1, #0	; R1 IS THE REVERSED BIT PATTERN
	LEA R2, RCOUNT
	LDR R2, R2, #0	; R2 IS THE REVERSE COUNT 16
	LEA R3, MASK
	LDR R3, R3, #0	; R3 IS THE TOP DIGIT MASK
	AND R4, R4, #0
	ADD R4, R4, #1	; R4 IS THE REVERSED DIGIT
RLOOP	AND R5, R0, R3	; GET THE TOP DIGIT
	BRN ISONE
	ADD R1, R1, R4	; THE TOP DIGIT IS 0
ISONE	ADD R4, R4, R4	; THE TOP DIGIT IS 1
	ADD R0, R0, R0
	ADD R2, R2, #-1
	BRP RLOOP
	NOT R0, R1	; R0 HAS BEEN REVERSED
	ADD R6, R6, #-1
	BRP SHIFT	; IF DO FIRST REVERSE, THEN WE NEED TO DO SHIFT
	STI R0, OUTPUT	; ELSE, OUTPUT
	TRAP x25

SHIFT	LDI R1, SCOUNT	; R1 IS THE SHIFT COUNT
SLOOP	ADD R0, R0, R0	; DO LEFT SHIFT
	ADD R1, R1, #-1
	BRP SLOOP
	BRNZP REVERSE


INPUT	.FILL x3100
OUTPUT	.FILL X3102
RCOUNT	.FILL #16
MASK	.FILL b1000000000000000
SCOUNT	.FILL x3101
TWO	.FILL #2

    	.END